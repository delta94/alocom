var FACEBOOK_ID=0,FULLNAME="";app.controller("GCController",function(n,e,o){var t=this,s="";t.today=function(){var n=new Date;return n.getDate()+"/"+(n.getMonth()+1)},t.menu={visible:!1,raw:"",array:[],host:{fbid:0,fullname:""},onConfirm:function(){this.visible=!1;for(var n=this.raw.split(/\s*\n\s*/),o=[],t=/^[0-9]+\.\s+.+$/,r=0;r<n.length;r++){var i=n[r];t.test(i)&&o.push(i)}console.log("con heo",o),e.post(s+"/menu",{menu:o,fbid:FACEBOOK_ID,fullname:FULLNAME}).success(function(n){console.log(n),u()})}},t.vote={doVote:function(n){e.post(s+"/vote",{dish:n.id,fbid:FACEBOOK_ID,fullname:FULLNAME}).success(function(){u()})},checkYou:function(n){for(var e=0;e<n.list.length;e++)if(n.list[e].fbid===FACEBOOK_ID)return!0;return!1}},t.users={all:[],checked:{}};var u=function(){e.get(s+"/menu").success(function(n){t.menu.array=n.menu,t.menu.host=n.host,t.users.checked={};for(var e=0;e<n.menu.length;e++)for(var o=n.menu[e].list,s=0;s<o.length;s++)t.users.checked[o[s].fbid]=!0;r()}).error(function(){t.menu.array=fakeMenu.menu})},r=function(){e.get(s+"/users").success(function(n){t.users.all=n.users})};u(),t.loggined=function(n,e){FACEBOOK_ID=n,FULLNAME=e,console.log("fbid = ",n,"name = ",e)},t.sendDone=function(){e.post(s+"/done",{fbid:FACEBOOK_ID,fullname:FULLNAME})},t.isHost=function(){return FACEBOOK_ID==t.menu.host.fbid},o(u,5e3)});